From d9e0ad9f216364afcada493678c85ba9612eac7b Mon Sep 17 00:00:00 2001
From: zhongjie <zhongjie.shi@intel.com>
Date: Thu, 14 Feb 2019 19:50:39 +0800
Subject: [PATCH] CVE-2017-5071 fix

Reference https://chromium.googlesource.com/v8/v8.git/+/4e78b5a70c6443e3829b0bef10fd731062e27aa3

Change-Id: I346e3bc8b43ee9b163359f3c2a0776a3cde7bf40
Tracked-On:
Signed-off-by: zhongjie <zhongjie.shi@intel.com>
---

diff --git a/src/asmjs/asm-wasm-builder.cc b/src/asmjs/asm-wasm-builder.cc
index 891cba3..a64769c 100644
--- a/src/asmjs/asm-wasm-builder.cc
+++ b/src/asmjs/asm-wasm-builder.cc
@@ -224,6 +224,7 @@
       }
       RECURSE(Visit(stmt));
       if (typer_failed_) break;
+      // Not stopping when a jump statement is found.
     }
   }
 
diff --git a/src/ast/ast-numbering.cc b/src/ast/ast-numbering.cc
index 499760d..eb6bdb7 100644
--- a/src/ast/ast-numbering.cc
+++ b/src/ast/ast-numbering.cc
@@ -616,6 +616,7 @@
   if (statements == NULL) return;
   for (int i = 0; i < statements->length(); i++) {
     Visit(statements->at(i));
+    if (statements->at(i)->IsJump()) break;
   }
 }
 
