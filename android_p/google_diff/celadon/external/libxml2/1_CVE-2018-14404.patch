From 95800f104abe6e22c9161dfe2e508cd8a55061ba Mon Sep 17 00:00:00 2001
From: zhongjie <zhongjie.shi@intel.com>
Date: Thu, 14 Feb 2019 19:25:54 +0800
Subject: [PATCH] VE-2018-14404 fix

Reference https://raw.githubusercontent.com/intel/luv-yocto/master/meta/recipes-core/libxml/libxml2/fix-CVE-2018-14404.patch

Change-Id: I9b7749afbad5a6dc8aa2615fe1eb085524645bed
Tracked-On:
Signed-off-by: zhongjie <zhongjie.shi@intel.com>
---

diff --git a/xpath.c b/xpath.c
index d134025..ad2b93e 100644
--- a/xpath.c
+++ b/xpath.c
@@ -13297,9 +13297,8 @@
 		return(0);
 	    }
             xmlXPathBooleanFunction(ctxt, 1);
-            arg1 = valuePop(ctxt);
-            arg1->boolval &= arg2->boolval;
-            valuePush(ctxt, arg1);
+	    if (ctxt->value != NULL)
+		ctxt->value->boolval &= arg2->boolval;
 	    xmlXPathReleaseObject(ctxt->context, arg2);
             return (total);
         case XPATH_OP_OR:
@@ -13323,9 +13322,8 @@
 		return(0);
 	    }
             xmlXPathBooleanFunction(ctxt, 1);
-            arg1 = valuePop(ctxt);
-            arg1->boolval |= arg2->boolval;
-            valuePush(ctxt, arg1);
+	    if (ctxt->value != NULL)
+		ctxt->value->boolval |= arg2->boolval;
 	    xmlXPathReleaseObject(ctxt->context, arg2);
             return (total);
         case XPATH_OP_EQUAL:
