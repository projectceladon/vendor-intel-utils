From d4178c29ae7b408b5cfee34ed17cf2ca75c103d7 Mon Sep 17 00:00:00 2001
From: zhongjie <zhongjie.shi@intel.com>
Date: Thu, 14 Feb 2019 19:51:31 +0800
Subject: [PATCH] CVE-2017-5088 fix

Reference https://chromium.googlesource.com/v8/v8.git/+/e23b659865e16de9482e19732650d57b3ff0b374

Change-Id: I38bb7f38f889d09820cab1faefcc3609b09ba0f0
Tracked-On:
Signed-off-by: zhongjie <zhongjie.shi@intel.com>
---

diff --git a/src/wasm/module-decoder.cc b/src/wasm/module-decoder.cc
index 440e5dc..0c765f2 100644
--- a/src/wasm/module-decoder.cc
+++ b/src/wasm/module-decoder.cc
@@ -196,7 +196,7 @@
 
       TRACE("Section: %s\n", SectionName(section_code_));
       if (section_code_ == kUnknownSectionCode &&
-          section_end_ > decoder_.pc()) {
+          section_end_ >= decoder_.pc()) {
         // skip to the end of the unknown section.
         uint32_t remaining =
             static_cast<uint32_t>(section_end_ - decoder_.pc());
