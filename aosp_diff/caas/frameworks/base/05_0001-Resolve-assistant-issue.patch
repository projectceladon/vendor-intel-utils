From 651502f7198e32a8c8bd3a17cac497cad6a92edb Mon Sep 17 00:00:00 2001
From: pmandri <padmasree.mandri@intel.com>
Date: Sun, 21 Jun 2020 22:01:33 +0530
Subject: [PATCH] Resolve assistant issue Resolve asistant launch issue when it
 is running in background

Tracked-On: OAM-91466
Signed-off-by: pmandri <padmasree.mandri@intel.com>
---
 services/core/java/com/android/server/audio/AudioService.java | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/services/core/java/com/android/server/audio/AudioService.java b/services/core/java/com/android/server/audio/AudioService.java
index 6d0e1a2fca8..eed21bf5925 100644
--- a/services/core/java/com/android/server/audio/AudioService.java
+++ b/services/core/java/com/android/server/audio/AudioService.java
@@ -1472,10 +1472,11 @@ public class AudioService extends IAudioService.Stub
         }
         if (!TextUtils.isEmpty(packageName)) {
             PackageManager pm = mContext.getPackageManager();
+            ActivityManager am = (ActivityManager)mContext.getSystemService(mContext.ACTIVITY_SERVICE);
             if (pm.checkPermission(Manifest.permission.CAPTURE_AUDIO_HOTWORD, packageName)
                     == PackageManager.PERMISSION_GRANTED) {
                 try {
-                    assistantUid = pm.getPackageUid(packageName, 0);
+                    assistantUid = pm.getPackageUidAsUser(packageName, am.getCurrentUser());
                 } catch (PackageManager.NameNotFoundException e) {
                     Log.e(TAG,
                             "updateAssistantUId() could not find UID for package: " + packageName);
-- 
2.17.1

