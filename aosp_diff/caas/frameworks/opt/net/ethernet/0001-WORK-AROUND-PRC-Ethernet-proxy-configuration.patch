From 806b59b33901ca6dc9b51f7bfb2c245958b7d152 Mon Sep 17 00:00:00 2001
From: Raveendra Babu Chennakesavulu <raveendra.babu.chennakesavulu@intel.com>
Date: Thu, 14 May 2020 17:16:39 +0530
Subject: [PATCH] [WORK AROUND] PRC Ethernet proxy configuration


diff --git a/aosp_diff/caas/frameworks/opt/net/ethernet/0001-eth-proxy-framework-opt.ethernet-changes.patch b/aosp_diff/caas/frameworks/opt/net/ethernet/0001-eth-proxy-framework-opt.ethernet-changes.patch
new file mode 100644
index 0000000..81e5aa5
--- /dev/null
+++ b/aosp_diff/caas/frameworks/opt/net/ethernet/0001-eth-proxy-framework-opt.ethernet-changes.patch
@@ -0,0 +1,40 @@
+From 3359ab02bb0203b3067d75e4c8d45be9f2b375a1 Mon Sep 17 00:00:00 2001
+From: Raveendra Babu Chennakesavulu <raveendra.babu.chennakesavulu@intel.com>
+Date: Wed, 22 Apr 2020 02:27:45 +0530
+Subject: [PATCH] eth proxy framework/opt...ethernet changes
+
+Tracked-On:
+
+diff --git a/java/com/android/server/ethernet/EthernetNetworkFactory.java b/java/com/android/server/ethernet/EthernetNetworkFactory.java
+index b8ed845..57b4b30 100644
+--- a/java/com/android/server/ethernet/EthernetNetworkFactory.java
++++ b/java/com/android/server/ethernet/EthernetNetworkFactory.java
+@@ -40,12 +40,15 @@ import android.net.ip.IpClientCallbacks;
+ import android.net.ip.IpClientUtil;
+ import android.net.shared.ProvisioningConfiguration;
+ import android.net.util.InterfaceParams;
++import android.net.ProxyInfo;
+ import android.os.ConditionVariable;
+ import android.os.Handler;
+ import android.os.RemoteException;
+ import android.text.TextUtils;
+ import android.util.AndroidRuntimeException;
+ import android.util.Log;
++import android.util.Slog;
++
+ import android.util.SparseArray;
+ 
+ import com.android.internal.util.IndentingPrintWriter;
+@@ -552,6 +555,12 @@ public class EthernetNetworkFactory extends NetworkFactory {
+ 
+         private static void provisionIpClient(IIpClient ipClient, IpConfiguration config,
+                 String tcpBufferSizes) {
++	    config.setProxySettings(ProxySettings.STATIC);
++	    ProxyInfo mHttpProxy = new ProxyInfo("child-prc.intel.com", 913, null);
++	    config.setHttpProxy(mHttpProxy);
++	    Slog.d(TAG, "Raveendra: post config proxysetting: " +
++			    config.getProxySettings() + "proxy: " +
++			    config.getHttpProxy());
+             if (config.getProxySettings() == ProxySettings.STATIC ||
+                     config.getProxySettings() == ProxySettings.PAC) {
+                 try {
-- 
2.17.1

