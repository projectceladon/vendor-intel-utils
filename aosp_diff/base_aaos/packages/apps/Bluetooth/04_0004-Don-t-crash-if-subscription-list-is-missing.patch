From 4d344e30fe73c3daf73ff1dfb0213fabdff43dae Mon Sep 17 00:00:00 2001
From: Gowtham Anandha Babu <gowtham.anandha.babu@intel.com>
Date: Mon, 20 Mar 2023 10:13:36 +0530
Subject: [PATCH] Don't crash if subscription list is missing

Taken from AOSP patch.
https://android-review.googlesource.com/c/platform/packages/modules/Bluetooth/+/2129638

Tracked-On: OAM-105937
Signed-off-by: Tomasz Wasilczyk <twasilczyk@google.com>
Signed-off-by: Gowtham Anandha Babu <gowtham.anandha.babu@intel.com>
---
 src/com/android/bluetooth/mapclient/MapClientContent.java | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/src/com/android/bluetooth/mapclient/MapClientContent.java b/src/com/android/bluetooth/mapclient/MapClientContent.java
index af06803aa..57592be07 100644
--- a/src/com/android/bluetooth/mapclient/MapClientContent.java
+++ b/src/com/android/bluetooth/mapclient/MapClientContent.java
@@ -136,6 +136,10 @@ class MapClientContent {
         SubscriptionManager subscriptionManager = (SubscriptionManager) context
                 .getSystemService(Context.TELEPHONY_SUBSCRIPTION_SERVICE);
         List<SubscriptionInfo> subscriptions = subscriptionManager.getActiveSubscriptionInfoList();
+        if (subscriptions == null) {
+            Log.w(TAG, "Active subscription list is missing");
+            return;
+        }
         for (SubscriptionInfo info : subscriptions) {
             if (info.getSubscriptionType() == SubscriptionManager.SUBSCRIPTION_TYPE_REMOTE_SIM) {
                 clearMessages(context, info.getSubscriptionId());
-- 
2.17.1

