From 07608f8ee6ed4e4025951fa0f7504e1f4acf7382 Mon Sep 17 00:00:00 2001
From: xubing <bing.xu@intel.com>
Date: Tue, 19 Dec 2023 14:33:08 +0800
Subject: [PATCH] debug patch for s3 error

Signed-off-by: xubing <bing.xu@intel.com>
---
 core/java/android/app/ActivityThread.java | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/core/java/android/app/ActivityThread.java b/core/java/android/app/ActivityThread.java
index 7f0c643577cf..9c65eb4b4ef9 100644
--- a/core/java/android/app/ActivityThread.java
+++ b/core/java/android/app/ActivityThread.java
@@ -258,7 +258,7 @@ public final class ActivityThread extends ClientTransactionHandler
     /** @hide */
     public static final String TAG = "ActivityThread";
     private static final android.graphics.Bitmap.Config THUMBNAIL_FORMAT = Bitmap.Config.RGB_565;
-    static final boolean localLOGV = false;
+    static final boolean localLOGV = true;
     static final boolean DEBUG_MESSAGES = false;
     /** @hide */
     public static final boolean DEBUG_BROADCAST = false;
@@ -3600,6 +3600,7 @@ public final class ActivityThread extends ClientTransactionHandler
             activity = mInstrumentation.newActivity(
                     cl, component.getClassName(), r.intent);
             StrictMode.incrementExpectedActivityCount(activity.getClass());
+            Slog.v(TAG, "XB StrictMode.incrementExpectedActivityCount appName:" + r);
             r.intent.setExtrasClassLoader(cl);
             r.intent.prepareToEnterProcess(isProtectedComponent(r.activityInfo),
                     appContext.getAttributionSource());
@@ -5471,6 +5472,9 @@ public final class ActivityThread extends ClientTransactionHandler
             mActivities.remove(r.token);
         }
         StrictMode.decrementExpectedActivityCount(activityClass);
+        Slog.v(
+            TAG, "XB StrictMode.decrementExpectedActivityCount r: " + r );
+            new Exception("XB").printStackTrace();
     }
 
     private static String safeToComponentShortString(Intent intent) {
-- 
2.34.1

