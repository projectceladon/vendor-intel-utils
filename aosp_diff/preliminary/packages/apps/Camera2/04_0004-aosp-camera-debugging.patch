From 031d92f5330f642ae89645c97f2a9d830309d13d Mon Sep 17 00:00:00 2001
From: shivasku82 <shiva.kumara.rudrappa@intel.com>
Date: Fri, 5 May 2023 21:11:33 +0530
Subject: [PATCH] aosp camera debugging

---
 src/com/android/camera/PhotoModule.java                         | 1 +
 src/com/android/camera/VideoModule.java                         | 1 +
 src/com/android/camera/one/v2/OneCameraImpl.java                | 1 +
 src/com/android/camera/one/v2/common/BasicCameraFactory.java    | 2 +-
 .../camera/one/v2/photo/ImageRotationCalculatorImpl.java        | 1 +
 src/com/android/camera/util/CameraUtil.java                     | 2 ++
 6 files changed, 7 insertions(+), 1 deletion(-)

diff --git a/src/com/android/camera/PhotoModule.java b/src/com/android/camera/PhotoModule.java
index 7f42aaac7..e067f3a15 100644
--- a/src/com/android/camera/PhotoModule.java
+++ b/src/com/android/camera/PhotoModule.java
@@ -1143,6 +1143,7 @@ public class PhotoModule
         int deviceOrientation =
                 mAppController.getOrientationManager().getDeviceOrientation().getDegrees();
         boolean isFrontCamera = info.isFacingFront();
+Log.e(TAG, "Shiva photo module sensor and \n"+sensorOrientation+" "+deviceOrientation);
         mJpegRotation =
                 CameraUtil.getImageRotation(sensorOrientation, deviceOrientation, isFrontCamera);
         mCameraDevice.setJpegOrientation(mJpegRotation);
diff --git a/src/com/android/camera/VideoModule.java b/src/com/android/camera/VideoModule.java
index c299c7d15..e7177f62a 100644
--- a/src/com/android/camera/VideoModule.java
+++ b/src/com/android/camera/VideoModule.java
@@ -1200,6 +1200,7 @@ public class VideoModule extends CameraModule
                 mAppController.getOrientationManager().getDeviceOrientation().getDegrees();
         int rotation = CameraUtil.getImageRotation(
                 sensorOrientation, deviceOrientation, isCameraFrontFacing());
+Log.e(TAG, "Shiva video module  \n"+sensorOrientation +" "+deviceOrientation +" "+rotation);
         mMediaRecorder.setOrientationHint(rotation);
 
         try {
diff --git a/src/com/android/camera/one/v2/OneCameraImpl.java b/src/com/android/camera/one/v2/OneCameraImpl.java
index d9c6b03a3..5993da89f 100644
--- a/src/com/android/camera/one/v2/OneCameraImpl.java
+++ b/src/com/android/camera/one/v2/OneCameraImpl.java
@@ -698,6 +698,7 @@ public class OneCameraImpl extends AbstractOneCamera {
     public void triggerFocusAndMeterAtPoint(float nx, float ny) {
         int sensorOrientation = mCharacteristics.get(
                 CameraCharacteristics.SENSOR_ORIENTATION);
+Log.e(TAG, "Shiva sensor in file 1 %d\n" +sensorOrientation);
         mAERegions = AutoFocusHelper.aeRegionsForNormalizedCoord(nx, ny, mCropRegion,
                 sensorOrientation);
         mAFRegions = AutoFocusHelper.afRegionsForNormalizedCoord(nx, ny, mCropRegion,
diff --git a/src/com/android/camera/one/v2/common/BasicCameraFactory.java b/src/com/android/camera/one/v2/common/BasicCameraFactory.java
index c42f447ca..d6a318e95 100644
--- a/src/com/android/camera/one/v2/common/BasicCameraFactory.java
+++ b/src/com/android/camera/one/v2/common/BasicCameraFactory.java
@@ -143,7 +143,7 @@ public class BasicCameraFactory {
         lifetime.add(hdrCallback);
 
         int sensorOrientation = cameraCharacteristics.getSensorOrientation();
-
+//Log.e(TAG, "Shiva shiva %d \n", sensorOrientation);
         ManualAutoFocusFactory manualAutoFocusFactory = ManualAutoFocusFactory.create(new
                 Lifetime(lifetime), frameServer, cameraCommandExecutor, cropRegion,
                 sensorOrientation, mPreviewUpdater, requestTemplate,
diff --git a/src/com/android/camera/one/v2/photo/ImageRotationCalculatorImpl.java b/src/com/android/camera/one/v2/photo/ImageRotationCalculatorImpl.java
index e82d4268e..503571c61 100644
--- a/src/com/android/camera/one/v2/photo/ImageRotationCalculatorImpl.java
+++ b/src/com/android/camera/one/v2/photo/ImageRotationCalculatorImpl.java
@@ -58,6 +58,7 @@ public class ImageRotationCalculatorImpl implements ImageRotationCalculator {
     public static ImageRotationCalculator from(OrientationManager orientationManager,
             OneCameraCharacteristics characteristics) {
         int sensorOrientation = characteristics.getSensorOrientation();
+//Log.e(TAG,"Shiva sensor ss %d\n",sensorOrientation);
         OneCamera.Facing lensDirection = characteristics.getCameraDirection();
         return new ImageRotationCalculatorImpl(orientationManager, sensorOrientation,
                 lensDirection == OneCamera.Facing.FRONT);
diff --git a/src/com/android/camera/util/CameraUtil.java b/src/com/android/camera/util/CameraUtil.java
index b6e11b88a..3a0a0c48c 100644
--- a/src/com/android/camera/util/CameraUtil.java
+++ b/src/com/android/camera/util/CameraUtil.java
@@ -1295,6 +1295,7 @@ public class CameraUtil {
         boolean isFrontCamera = characteristics.get(CameraCharacteristics.LENS_FACING) ==
                 CameraMetadata.LENS_FACING_FRONT;
         int sensorOrientation = characteristics.get(CameraCharacteristics.SENSOR_ORIENTATION);
+Log.e(TAG, "Shiva sensor Orientation  device orientation" +deviceOrientationDegrees);
         return getImageRotation(sensorOrientation, deviceOrientationDegrees, isFrontCamera);
     }
 
@@ -1316,6 +1317,7 @@ public class CameraUtil {
         if (isFrontCamera) {
             deviceOrientation = (360 - deviceOrientation) % 360;
         }
+Log.e(TAG, "Shiva getImageRotation "+sensorOrientation +" "+deviceOrientation);
         return (sensorOrientation + deviceOrientation) % 360;
     }
 }
-- 
2.17.1

