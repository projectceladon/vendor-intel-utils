From 8ca23f2fe6fee0313e45f6acacaf4f9a82a5728f Mon Sep 17 00:00:00 2001
From: sgnanase <sundar.gnanasekaran@intel.com>
Date: Tue, 23 Feb 2021 16:15:20 +0530
Subject: [PATCH] Debug logs

Tracked-On: OAM-94662
Signed-off-by: pmandri <padmashree.mandri@intel.com>
---
 adb/daemon/main.cpp | 1 +
 adb/daemon/usb.cpp  | 8 +++++++-
 2 files changed, 8 insertions(+), 1 deletion(-)

diff --git a/adb/daemon/main.cpp b/adb/daemon/main.cpp
index ad660cf75..8c576afbb 100644
--- a/adb/daemon/main.cpp
+++ b/adb/daemon/main.cpp
@@ -241,6 +241,7 @@ int adbd_main(int server_port) {
 #if defined(__ANDROID__)
     if ((access(USB_FFS_ADB_EP0, F_OK) == 0) || (access(USB_DBC_ADB_PATH,F_OK) == 0)) {
         // Listen on USB.
+		LOG(INFO) << "Padma : inside adb main.";
         usb_init();
         is_usb = true;
     }
diff --git a/adb/daemon/usb.cpp b/adb/daemon/usb.cpp
index 9d4727554..908b02552 100644
--- a/adb/daemon/usb.cpp
+++ b/adb/daemon/usb.cpp
@@ -178,7 +178,9 @@ struct UsbFfsConnection : public Connection {
           control_fd_(std::move(control)),
           read_fd_(std::move(read)),
           write_fd_(std::move(write)) {
+        LOG(INFO) << "Padma: UsbFfsConnection constructed";
         LOG(INFO) << "UsbFfsConnection constructed";
+        LOG(INFO) << "Padma: UsbFfsConnection constructed";
         worker_event_fd_.reset(eventfd(0, EFD_CLOEXEC));
         if (worker_event_fd_ == -1) {
             PLOG(FATAL) << "failed to create eventfd";
@@ -778,7 +780,11 @@ static void usb_ffs_open_thread() {
 }
 
 void usb_init() {
-    if (access(USB_DBC_ADB_PATH,F_OK) == 0)
+    int err;
+    err = access(USB_DBC_ADB_PATH,F_OK);
+
+    LOG(INFO) << "Padma : dbc path access error no : " << err;
+    if (1)
         std::thread(usb_dbc_open_thread).detach();
     else
         std::thread(usb_ffs_open_thread).detach();
-- 
2.30.0

