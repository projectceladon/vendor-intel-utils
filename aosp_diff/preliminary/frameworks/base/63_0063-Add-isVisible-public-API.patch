From 997922c94ffe55ee6dc377395ca42927d9ead666 Mon Sep 17 00:00:00 2001
From: ahs <amrita.h.s@intel.com>
Date: Mon, 31 Oct 2022 08:08:19 +0000
Subject: [PATCH] Add isVisible public API.

Task visibilty info will help us decide if correspoding
LG window should be closed or not.

This patch also adds TASK permission to ClipboardAgent
private app.

Tracked-On: OAM-104429
Signed-off-by: ahs <amrita.h.s@intel.com>
---
 core/api/current.txt                      | 1 +
 core/java/android/app/TaskInfo.java       | 4 ++++
 data/etc/privapp-permissions-platform.xml | 1 +
 3 files changed, 6 insertions(+)

diff --git a/core/api/current.txt b/core/api/current.txt
index 1de47b548a5c..6c884e1cf46c 100644
--- a/core/api/current.txt
+++ b/core/api/current.txt
@@ -6707,6 +6707,7 @@ package android.app {
   }
 
   public class TaskInfo {
+    method public boolean isVisible();
     field @Nullable public android.content.ComponentName baseActivity;
     field @NonNull public android.content.Intent baseIntent;
     field public boolean isRunning;
diff --git a/core/java/android/app/TaskInfo.java b/core/java/android/app/TaskInfo.java
index 85758a92fa98..723644fad6b8 100644
--- a/core/java/android/app/TaskInfo.java
+++ b/core/java/android/app/TaskInfo.java
@@ -472,4 +472,8 @@ public class TaskInfo {
                 + " locusId= " + mTopActivityLocusId
                 + "}";
     }
+
+    public boolean isVisible() {
+        return isVisible;
+    }
 }
diff --git a/data/etc/privapp-permissions-platform.xml b/data/etc/privapp-permissions-platform.xml
index 8c820f89fda4..aa3a1b819064 100644
--- a/data/etc/privapp-permissions-platform.xml
+++ b/data/etc/privapp-permissions-platform.xml
@@ -555,6 +555,7 @@ applications that come with the platform
         <permission name="android.permission.INTERNAL_SYSTEM_WINDOW"/>
         <permission name="android.permission.INTERNET"/>
         <permission name="android.permission.PACKAGE_USAGE_STATS"/>
+        <permission name="android.permission.GET_TASKS"/>
     </privapp-permissions>
     
 </permissions>
-- 
2.37.1

