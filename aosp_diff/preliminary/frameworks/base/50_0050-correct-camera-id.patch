From 232c4395dc5c1b20c529bd4a83981417d11c5af6 Mon Sep 17 00:00:00 2001
From: shivasku82 <shiva.kumara.rudrappa@intel.com>
Date: Wed, 20 Jul 2022 19:32:31 +0530
Subject: [PATCH] correct camera id

---
 core/jni/android_hardware_Camera.cpp | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

diff --git a/core/jni/android_hardware_Camera.cpp b/core/jni/android_hardware_Camera.cpp
index cee17c5fc4cc..01c78d217cde 100644
--- a/core/jni/android_hardware_Camera.cpp
+++ b/core/jni/android_hardware_Camera.cpp
@@ -536,7 +536,10 @@ static void android_hardware_Camera_getCameraInfo(JNIEnv *env, jobject thiz,
     if (cameraId >= Camera::getNumberOfCameras() || cameraId < 0) {
         ALOGE("%s: Unknown camera ID %d", __FUNCTION__, cameraId);
         jniThrowRuntimeException(env, "Unknown camera ID");
-        return;
+        if(Camera::getNumberOfCameras() == 0)
+            return;
+        else
+            cameraId =0;
     }
 
     status_t rc = Camera::getCameraInfo(cameraId, &cameraInfo);
@@ -568,6 +571,9 @@ static jint android_hardware_Camera_native_setup(JNIEnv *env, jobject thiz,
 {
 
     // Convert jstring to String16
+    if (cameraId >= Camera::getNumberOfCameras() || cameraId < 0) {
+         cameraId =0;
+    }
     const char16_t *rawClientName = reinterpret_cast<const char16_t*>(
         env->GetStringChars(clientPackageName, NULL));
     jsize rawClientNameLen = env->GetStringLength(clientPackageName);
-- 
2.17.1

