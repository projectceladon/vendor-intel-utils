From e1da5c1aa79f7e51b62205760ec07278ce5b45b8 Mon Sep 17 00:00:00 2001
From: "Wang, Yiyang" <yiyang.wang@intel.com>
Date: Fri, 5 Jan 2024 13:07:31 +0000
Subject: [PATCH] display porting

Signed-off-by: Wang, Yiyang <yiyang.wang@intel.com>
---
 drivers/gpu/drm/i915/display/intel_ddi.c | 11 ++++++++++-
 drivers/mfd/intel-lpss-pci.c             |  1 +
 2 files changed, 11 insertions(+), 1 deletion(-)

diff --git a/drivers/gpu/drm/i915/display/intel_ddi.c b/drivers/gpu/drm/i915/display/intel_ddi.c
index bf16c4a35274..bbc5ee72cd50 100644
--- a/drivers/gpu/drm/i915/display/intel_ddi.c
+++ b/drivers/gpu/drm/i915/display/intel_ddi.c
@@ -4398,9 +4398,18 @@ intel_ddi_hotplug(struct intel_encoder *encoder,
 static bool lpt_digital_port_connected(struct intel_encoder *encoder)
 {
 	struct drm_i915_private *dev_priv = to_i915(encoder->base.dev);
+	struct device *dev = (&dev_priv->drm)->dev;
+	bool ret;
 	u32 bit = dev_priv->hotplug.pch_hpd[encoder->hpd_pin];
 
-	return intel_de_read(dev_priv, SDEISR) & bit;
+	ret =  intel_de_read(dev_priv, SDEISR) & bit;
+
+	if (!strcmp(dev_name(dev), "0000:00:02.0")) {
+	} else {
+		ret = true;
+	}
+
+	return ret;
 }
 
 static bool hsw_digital_port_connected(struct intel_encoder *encoder)
diff --git a/drivers/mfd/intel-lpss-pci.c b/drivers/mfd/intel-lpss-pci.c
index bae35f31f07a..5e7c049f136f 100644
--- a/drivers/mfd/intel-lpss-pci.c
+++ b/drivers/mfd/intel-lpss-pci.c
@@ -354,6 +354,7 @@ static const struct pci_device_id intel_lpss_pci_ids[] = {
 	{ PCI_VDEVICE(INTEL, 0x51c5), (kernel_ulong_t)&bxt_i2c_info },
 	{ PCI_VDEVICE(INTEL, 0x51c6), (kernel_ulong_t)&bxt_i2c_info },
 	{ PCI_VDEVICE(INTEL, 0x51c7), (kernel_ulong_t)&bxt_uart_info },
+	{ PCI_VDEVICE(INTEL, 0x51d9), (kernel_ulong_t)&bxt_i2c_info },
 	{ PCI_VDEVICE(INTEL, 0x51e8), (kernel_ulong_t)&bxt_i2c_info },
 	{ PCI_VDEVICE(INTEL, 0x51e9), (kernel_ulong_t)&bxt_i2c_info },
 	{ PCI_VDEVICE(INTEL, 0x51ea), (kernel_ulong_t)&bxt_i2c_info },
-- 
2.34.1

