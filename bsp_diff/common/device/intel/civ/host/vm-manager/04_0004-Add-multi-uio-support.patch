From 8656df875b2b860ef5744cfa35ebd38f50b30933 Mon Sep 17 00:00:00 2001
From: renchenglei <chenglei.ren@intel.com>
Date: Wed, 7 Apr 2021 21:42:24 +0800
Subject: [PATCH] Add multi uio support

Tracked-On:
---
 scripts/start_civ.sh | 11 +++++++++--
 1 file changed, 9 insertions(+), 2 deletions(-)

diff --git a/scripts/start_civ.sh b/scripts/start_civ.sh
index 9128efa1062c..2b8dfb409321 100755
--- a/scripts/start_civ.sh
+++ b/scripts/start_civ.sh
@@ -325,8 +325,15 @@ function setup_gvtg() {
 
 function setup_virtio_gpu() {
     GUEST_VGA_DEV="-device virtio-gpu-pci"
-    GUEST_SHM_CMD="-device ivshmem-plain,memdev=ivshmem,bus=pcie.0 \
-            -object memory-backend-file,id=ivshmem,share=on,mem-path=/dev/shm/looking-glass,size=32M"
+    GUEST_SHM_CMD="
+            -device ivshmem-plain,memdev=ivshmem0,bus=pcie.0 \
+            -object memory-backend-file,id=ivshmem0,share=on,mem-path=/dev/shm/looking-glass0,size=32M \
+            -device ivshmem-plain,memdev=ivshmem1,bus=pcie.0 \
+            -object memory-backend-file,id=ivshmem1,share=on,mem-path=/dev/shm/looking-glass1,size=32M \
+            -device ivshmem-plain,memdev=ivshmem2,bus=pcie.0 \
+            -object memory-backend-file,id=ivshmem2,share=on,mem-path=/dev/shm/looking-glass2,size=32M \
+            -device ivshmem-plain,memdev=ivshmem3,bus=pcie.0 \
+            -object memory-backend-file,id=ivshmem3,share=on,mem-path=/dev/shm/looking-glass3,size=32M"
     GUEST_SPICE_CMD="-spice port=5900,disable-ticketing"
 
     shift #skip first param: VirtIO
-- 
2.17.1

