From e4d91f157cf97e78c984757f561d7750c4f9f0cf Mon Sep 17 00:00:00 2001
From: renchenglei <chenglei.ren@intel.com>
Date: Sun, 14 Mar 2021 20:10:57 +0800
Subject: [PATCH 3/3] Add UIO device mixin changes

We need 0600 to read & write uio device

Tracked-On:
---
 groups/uio/default             |  1 +
 groups/uio/doc.spec            | 22 ++++++++++++++++++++++
 groups/uio/false/empty_dir     |  0
 groups/uio/true/BoardConfig.mk |  1 +
 groups/uio/true/init.rc        |  4 ++++
 5 files changed, 28 insertions(+)
 create mode 120000 groups/uio/default
 create mode 100644 groups/uio/doc.spec
 create mode 100644 groups/uio/false/empty_dir
 create mode 100644 groups/uio/true/BoardConfig.mk
 create mode 100644 groups/uio/true/init.rc

diff --git a/groups/uio/default b/groups/uio/default
new file mode 120000
index 000000000000..02e4a84d62c4
--- /dev/null
+++ b/groups/uio/default
@@ -0,0 +1 @@
+false
\ No newline at end of file
diff --git a/groups/uio/doc.spec b/groups/uio/doc.spec
new file mode 100644
index 000000000000..a0fad17cc314
--- /dev/null
+++ b/groups/uio/doc.spec
@@ -0,0 +1,22 @@
+=== Overview
+
+For UIO device
+
+--- deps
+
+    - sepolicy
+
+
+==== Options
+
+--- true
+this option will enable UIO device.
+
+    --- code dir
+        - kernel/lts2019-chromium/drivers/uio
+
+--- false
+this option will disable UIO device.
+
+--- default
+when not explicitly selected in mixin spec file, the default option will be used.
diff --git a/groups/uio/false/empty_dir b/groups/uio/false/empty_dir
new file mode 100644
index 000000000000..e69de29bb2d1
diff --git a/groups/uio/true/BoardConfig.mk b/groups/uio/true/BoardConfig.mk
new file mode 100644
index 000000000000..5ed451f928be
--- /dev/null
+++ b/groups/uio/true/BoardConfig.mk
@@ -0,0 +1 @@
+BOARD_SEPOLICY_DIRS += $(INTEL_PATH_SEPOLICY)/uio
diff --git a/groups/uio/true/init.rc b/groups/uio/true/init.rc
new file mode 100644
index 000000000000..f58c486181e4
--- /dev/null
+++ b/groups/uio/true/init.rc
@@ -0,0 +1,4 @@
+#For UIO device
+on post-fs
+    chmod 0660 /dev/uio0
+    chown system system /dev/uio0
-- 
2.17.1

