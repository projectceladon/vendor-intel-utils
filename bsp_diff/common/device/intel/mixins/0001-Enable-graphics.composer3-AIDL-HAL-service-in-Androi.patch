From 8cfe3758f99a7a81803c5c5e2cd674c0b03e3e20 Mon Sep 17 00:00:00 2001
From: HeYue <yue.he@intel.com>
Date: Thu, 18 Jul 2024 15:40:10 +0800
Subject: [PATCH] Enable graphics.composer3 AIDL HAL service in Android U.

Refine the patch due to conflict

Tracked-On: OAM-110596
Signed-off-by: manxiaoliang <xiaoliangx.man@intel.com>
---
 groups/device-specific/caas/manifest.xml | 8 ++++++++
 groups/device-specific/caas/product.mk   | 1 +
 groups/graphics/auto/BoardConfig.mk      | 2 ++
 3 files changed, 11 insertions(+)

diff --git a/groups/device-specific/caas/manifest.xml b/groups/device-specific/caas/manifest.xml
index 25705c9d4552..f01e47483b03 100644
--- a/groups/device-specific/caas/manifest.xml
+++ b/groups/device-specific/caas/manifest.xml
@@ -27,6 +27,14 @@
             <instance>default</instance>
         </interface>
     </hal>
+    <hal format="aidl">
+        <name>android.hardware.graphics.composer3</name>
+        <version>2</version>
+        <interface>
+            <name>IComposer</name>
+            <instance>default</instance>
+        </interface>
+    </hal>
     <hal format="hidl">
        <name>android.hardware.bluetooth</name>
        <transport>hwbinder</transport>
diff --git a/groups/device-specific/caas/product.mk b/groups/device-specific/caas/product.mk
index add83bfe944c..c75eeac2d718 100755
--- a/groups/device-specific/caas/product.mk
+++ b/groups/device-specific/caas/product.mk
@@ -31,6 +31,7 @@ PRODUCT_PACKAGES +=  \
                     android.hardware.renderscript@1.0-impl \
                     android.hardware.identity \
                     android.hardware.identity-service.example \
+                    android.hardware.graphics.composer3-service.intel \
                     android.hardware.media.omx@1.0-service
 
 
diff --git a/groups/graphics/auto/BoardConfig.mk b/groups/graphics/auto/BoardConfig.mk
index dc23d35bf890..8df8d2f9d6a9 100755
--- a/groups/graphics/auto/BoardConfig.mk
+++ b/groups/graphics/auto/BoardConfig.mk
@@ -63,4 +63,6 @@ BOARD_SEPOLICY_DIRS += $(INTEL_PATH_SEPOLICY)/graphics/opencl
 #Add app_render_setting_property folder to BOARD_SEPOLICY_DIRS
 BOARD_SEPOLICY_DIRS += $(INTEL_PATH_SEPOLICY)/app_render_setting_property
 
+BOARD_SEPOLICY_DIRS += $(INTEL_PATH_SEPOLICY)/graphics/composer3
+
 BOARD_SEPOLICY_M4DEFS += module_hwc_info_service=true
-- 
2.43.2

