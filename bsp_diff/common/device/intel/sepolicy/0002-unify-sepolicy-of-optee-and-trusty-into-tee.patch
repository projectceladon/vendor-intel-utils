From b6871b9c7b88e95a7655280f742c00a1a2ac630d Mon Sep 17 00:00:00 2001
From: "Yan, Shaopu" <shaopu.yan@intel.com>
Date: Thu, 28 Sep 2023 05:17:02 +0800
Subject: [PATCH] unify sepolicy of optee and trusty into tee

Signed-off-by: Yan, Shaopu <shaopu.yan@intel.com>
---
 {optee => tee}/disabled/file_contexts         | 0
 {optee/enabled => tee/optee}/file_contexts    | 0
 {optee/enabled => tee/optee}/tee.te           | 0
 {trusty/enabled => tee/trusty}/file_contexts  | 0
 {trusty/enabled => tee/trusty}/gatekeeperd.te | 0
 {trusty/enabled => tee/trusty}/tee.te         | 0
 trusty/disabled/file_contexts                 | 5 -----
 7 files changed, 5 deletions(-)
 rename {optee => tee}/disabled/file_contexts (100%)
 rename {optee/enabled => tee/optee}/file_contexts (100%)
 rename {optee/enabled => tee/optee}/tee.te (100%)
 rename {trusty/enabled => tee/trusty}/file_contexts (100%)
 rename {trusty/enabled => tee/trusty}/gatekeeperd.te (100%)
 rename {trusty/enabled => tee/trusty}/tee.te (100%)
 delete mode 100644 trusty/disabled/file_contexts

diff --git a/optee/disabled/file_contexts b/tee/disabled/file_contexts
similarity index 100%
rename from optee/disabled/file_contexts
rename to tee/disabled/file_contexts
diff --git a/optee/enabled/file_contexts b/tee/optee/file_contexts
similarity index 100%
rename from optee/enabled/file_contexts
rename to tee/optee/file_contexts
diff --git a/optee/enabled/tee.te b/tee/optee/tee.te
similarity index 100%
rename from optee/enabled/tee.te
rename to tee/optee/tee.te
diff --git a/trusty/enabled/file_contexts b/tee/trusty/file_contexts
similarity index 100%
rename from trusty/enabled/file_contexts
rename to tee/trusty/file_contexts
diff --git a/trusty/enabled/gatekeeperd.te b/tee/trusty/gatekeeperd.te
similarity index 100%
rename from trusty/enabled/gatekeeperd.te
rename to tee/trusty/gatekeeperd.te
diff --git a/trusty/enabled/tee.te b/tee/trusty/tee.te
similarity index 100%
rename from trusty/enabled/tee.te
rename to tee/trusty/tee.te
diff --git a/trusty/disabled/file_contexts b/trusty/disabled/file_contexts
deleted file mode 100644
index 7f1afc2..0000000
--- a/trusty/disabled/file_contexts
+++ /dev/null
@@ -1,5 +0,0 @@
-/vendor/bin/hw/android.hardware.gatekeeper@1.0-service.software    u:object_r:hal_gatekeeper_default_exec:s0
-
-/vendor/bin/hw/android.hardware.keymaster@3.0-service      u:object_r:hal_keymaster_default_exec:s0
-/vendor/bin/hw/android.hardware.keymaster@4.0-service      u:object_r:hal_keymaster_default_exec:s0
-/vendor/bin/hw/android.hardware.security.keymint-service      u:object_r:hal_keymint_default_exec:s0
-- 
2.25.1

