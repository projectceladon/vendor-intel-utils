From e7886ae3be0e8eacd114180447f1079b5155fa0a Mon Sep 17 00:00:00 2001
From: Ratnesh Kumar Rai <ratnesh.kumar.rai@intel.com>
Date: Thu, 8 Sep 2022 21:06:38 +0530
Subject: [PATCH] Modify trace dump path to sepolicy allowed path

Tracked-On: OAM-103798
Signed-off-by: Ratnesh Kumar Rai <ratnesh.kumar.rai@intel.com>
---
 cmake/android/environment.cmake      | 2 +-
 src/tbb/tools_api/ittnotify_static.c | 6 +++---
 2 files changed, 4 insertions(+), 4 deletions(-)

diff --git a/cmake/android/environment.cmake b/cmake/android/environment.cmake
index c209dfc5..5a6beba9 100644
--- a/cmake/android/environment.cmake
+++ b/cmake/android/environment.cmake
@@ -12,7 +12,7 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-set(ANDROID_DEVICE_TESTING_DIRECTORY "/data/local/tmp/tbb_testing")
+set(ANDROID_DEVICE_TESTING_DIRECTORY "/data/vendor/neuralnetworks/tbb_testing")
 
 find_program(adb_executable adb)
 if (NOT adb_executable)
diff --git a/src/tbb/tools_api/ittnotify_static.c b/src/tbb/tools_api/ittnotify_static.c
index dd8ca8e7..a3ea81b9 100644
--- a/src/tbb/tools_api/ittnotify_static.c
+++ b/src/tbb/tools_api/ittnotify_static.c
@@ -72,7 +72,7 @@ static const char* ittnotify_lib_name = "libittnotify.dylib";
 #endif
 
 /* default location of userapi collector on Android */
-#define ANDROID_ITTNOTIFY_DEFAULT_PATH_MASK(x)  "/data/data/com.intel.vtune/perfrun/lib" \
+#define ANDROID_ITTNOTIFY_DEFAULT_PATH_MASK(x)  "/data/vendor/neuralnetworks/com.intel.vtune/perfrun/lib" \
                                                 #x "/runtime/libittnotify.so"
 
 #if ITT_ARCH==ITT_ARCH_IA32 || ITT_ARCH==ITT_ARCH_ARM
@@ -836,7 +836,7 @@ static const char* __itt_get_lib_name(void)
         int itt_marker_file_fd = -1;
         ssize_t res = 0;
 
-        res = snprintf(system_wide_marker_filename, PATH_MAX - 1, "%s%s", "/data/local/tmp/", marker_filename);
+        res = snprintf(system_wide_marker_filename, PATH_MAX - 1, "%s%s", "/data/vendor/neuralnetworks/", marker_filename);
         if (res < 0)
         {
             ITT_ANDROID_LOGE("Unable to concatenate marker file string.");
@@ -885,7 +885,7 @@ static const char* __itt_get_lib_name(void)
                 return lib_name;
             }
             ITT_ANDROID_LOGI("Package name: %s\n", package_name);
-            res = snprintf(app_sandbox_file, PATH_MAX - 1, "/data/data/%s/%s", package_name, marker_filename);
+            res = snprintf(app_sandbox_file, PATH_MAX - 1, "/data/vendor/neuralnetworks/%s/%s", package_name, marker_filename);
             if (res < 0)
             {
                 ITT_ANDROID_LOGE("Unable to concatenate marker file string.");
-- 
2.17.1

