From f754b442ca407c25e89a33ed9130ac9ef8410009 Mon Sep 17 00:00:00 2001
From: yingzhex <yingzhenx.li@intel.com>
Date: Mon, 4 Jan 2021 19:35:19 +0800
Subject: [PATCH] Allow all users to show dialog

Change-Id: Ia60367e61228dd9f539f6b10cc5ff042c740096a
Tracked-On: ACP-1417
Signed-off-by: yingzhex <yingzhenx.li@intel.com>
---
 services/core/java/com/android/server/wm/WindowState.java | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/services/core/java/com/android/server/wm/WindowState.java b/services/core/java/com/android/server/wm/WindowState.java
index 11db705f4e0..6529e27e1c8 100644
--- a/services/core/java/com/android/server/wm/WindowState.java
+++ b/services/core/java/com/android/server/wm/WindowState.java
@@ -232,6 +232,7 @@ import android.view.animation.AnimationUtils;
 import android.view.animation.Interpolator;
 
 import com.android.internal.annotations.VisibleForTesting;
+import com.android.internal.os.RoSystemProperties;
 import com.android.internal.policy.KeyInterceptionInfo;
 import com.android.internal.util.FrameworkStatsLog;
 import com.android.internal.util.ToBooleanFunction;
@@ -3404,6 +3405,10 @@ class WindowState extends WindowContainer<WindowState> implements WindowManagerP
             }
         }
 
+        if (RoSystemProperties.SUPPORT_CONCURRENT_USER) {
+            return true;
+        }
+
         return win.showForAllUsers()
                 || mWmService.isCurrentProfile(win.mShowUserId);
     }
-- 
2.25.1

