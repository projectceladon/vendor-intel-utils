From 40ae60df4686117d7705d592820433db090c27cb Mon Sep 17 00:00:00 2001
From: "Yan, Shaopu" <shaopu.yan@intel.com>
Date: Tue, 26 May 2020 16:16:09 +0800
Subject: [PATCH] configuration of hidl service in mixin

Tracked-On:
Signed-off-by: Yan, Shaopu <shaopu.yan@intel.com>
---
 groups/device-specific/cic/sepolicy/file_contexts      | 3 +++
 groups/device-specific/cic/sepolicy/hwservice_contexts | 1 +
 groups/device-specific/cic_dev/manifest.xml            | 9 +++++++++
 groups/device-specific/cic_dev/product.mk              | 2 ++
 4 files changed, 15 insertions(+)
 create mode 100644 groups/device-specific/cic/sepolicy/hwservice_contexts

diff --git a/groups/device-specific/cic/sepolicy/file_contexts b/groups/device-specific/cic/sepolicy/file_contexts
index 0866136..6c80560 100644
--- a/groups/device-specific/cic/sepolicy/file_contexts
+++ b/groups/device-specific/cic/sepolicy/file_contexts
@@ -1,4 +1,5 @@
 /dev/dri(/.*)?              u:object_r:gpu_device:s0
+
 /android-entry              u:object_r:rootfs:s0
 /[^/]+\.img                 u:object_r:rootfs:s0
 /ipc(/.*)?                  u:object_r:rootfs:s0
@@ -11,3 +12,5 @@
 /etc(/.*)?                  u:object_r:system_file:s0
 
 /(vendor|system/vendor)/bin/hw/android\.hardware\.health@2\.0-service\.intel         u:object_r:hal_health_default_exec:s0
+/(vendor|system/vendor)/bin/hw/android\.hardware\.helloworld@1\.0-service      u:object_r:hal_keymaster_default_exec:s0
+/(vendor|system/vendor)/bin/hello_client      u:object_r:hal_keymaster_default_exec:s0
diff --git a/groups/device-specific/cic/sepolicy/hwservice_contexts b/groups/device-specific/cic/sepolicy/hwservice_contexts
new file mode 100644
index 0000000..ad0a4ae
--- /dev/null
+++ b/groups/device-specific/cic/sepolicy/hwservice_contexts
@@ -0,0 +1 @@
+android.hardware.helloworld::IHelloWorld                    u:object_r:hal_keymaster_hwservice:s0
diff --git a/groups/device-specific/cic_dev/manifest.xml b/groups/device-specific/cic_dev/manifest.xml
index a8bf884..b6a2245 100644
--- a/groups/device-specific/cic_dev/manifest.xml
+++ b/groups/device-specific/cic_dev/manifest.xml
@@ -52,6 +52,15 @@
             <instance>default</instance>
         </interface>
     </hal>
+    <hal format="hidl">
+        <name>android.hardware.helloworld</name>
+        <transport>hwbinder</transport>
+        <version>1.0</version>
+        <interface>
+            <name>IHelloWorld</name>
+            <instance>default</instance>
+        </interface>
+    </hal>
     <hal format="hidl">
         <name>android.hardware.keymaster</name>
         <transport>hwbinder</transport>
diff --git a/groups/device-specific/cic_dev/product.mk b/groups/device-specific/cic_dev/product.mk
index da0b551..7d732b4 100644
--- a/groups/device-specific/cic_dev/product.mk
+++ b/groups/device-specific/cic_dev/product.mk
@@ -15,6 +15,8 @@ PRODUCT_COPY_FILES += \
 PRODUCT_PACKAGES += \
     android.hardware.keymaster@3.0-impl \
     android.hardware.keymaster@3.0-service \
+	android.hardware.helloworld@1.0-service \
+	hello_client \
 
 ifeq ($(TARGET_DM_VERITY_SUPPORT), true)
 PRODUCT_PACKAGES += build_verity_img.py
-- 
2.25.2

