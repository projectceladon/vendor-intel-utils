From 880fcd761711f30d4d8f76ca816f14ce231812d4 Mon Sep 17 00:00:00 2001
From: sgnanase <sundar.gnanasekaran@intel.com>
Date: Thu, 13 May 2021 21:22:30 +0530
Subject: [PATCH] CIC TGL NPI Patches

Resolve compilation issues

Change-Id: Id7360d0da3b87493193d480fc0c78c65dc1fc108
Tracked-On: OAM-97081
Signed-off-by: sgnanase <sundar.gnanasekaran@intel.com>
---
 _studio/mfx_lib/decode/vp8/src/mfx_vp8_dec_decode_hw.cpp | 6 +++---
 android/include/mfx_android_defs.h                       | 4 ++--
 2 files changed, 5 insertions(+), 5 deletions(-)

diff --git a/_studio/mfx_lib/decode/vp8/src/mfx_vp8_dec_decode_hw.cpp b/_studio/mfx_lib/decode/vp8/src/mfx_vp8_dec_decode_hw.cpp
index f14a52e3..486c5505 100644
--- a/_studio/mfx_lib/decode/vp8/src/mfx_vp8_dec_decode_hw.cpp
+++ b/_studio/mfx_lib/decode/vp8/src/mfx_vp8_dec_decode_hw.cpp
@@ -1307,20 +1307,20 @@ mfxStatus VideoDECODEVP8_HW::DecodeFrameHeader(mfxBitstream *in)
         while (++i < 2);
     }
 
-#if !defined(ANDROID) || (MFX_ANDROID_VERSION >= MFX_P)
+//#if !defined(ANDROID) || (MFX_ANDROID_VERSION >= MFX_P)
     // Header info consumed bits
     m_frame_info.entropyDecSize = m_boolDecoder[VP8_FIRST_PARTITION].pos() * 8 - 3*8 - m_boolDecoder[VP8_FIRST_PARTITION].bitcount();
 
     // Subtract completely consumed bytes + current byte. Current is completely consumed if bitcount is 8.
     m_frame_info.firstPartitionSize = first_partition_size - ((m_frame_info.entropyDecSize + 7) >> 3);
-#else
+/*#else
     // On Android O we use old version of driver and should use special code for 1st partition size computation (for count == 8)
     // Header info consumed bits
     m_frame_info.entropyDecSize = m_boolDecoder[VP8_FIRST_PARTITION].pos() * 8 - 16 - m_boolDecoder[VP8_FIRST_PARTITION].bitcount();
 
     int fix = (m_boolDecoder[VP8_FIRST_PARTITION].bitcount() & 0x7) ? 1 : 0;
     m_frame_info.firstPartitionSize = m_frame_info.firstPartitionSize - (m_boolDecoder[VP8_FIRST_PARTITION].pos() - 3 + fix);
-#endif
+#endif */
 
     return MFX_ERR_NONE;
 }
diff --git a/android/include/mfx_android_defs.h b/android/include/mfx_android_defs.h
index 3123a4c8..4c23f535 100644
--- a/android/include/mfx_android_defs.h
+++ b/android/include/mfx_android_defs.h
@@ -47,8 +47,8 @@
 
   #define MFX_ENABLE_USER_ENCODE
 
-#if MFX_ANDROID_VERSION >= MFX_P
+//#if MFX_ANDROID_VERSION >= MFX_P
   #define MFX_ENABLE_KERNELS
-#endif
+//#endif
 
 #endif // #ifndef __MFX_ANDROID_DEFS_H__
-- 
2.30.0

