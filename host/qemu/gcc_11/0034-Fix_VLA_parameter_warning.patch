From 3ad3f6d42c5f7c006064344ef195be5d57453c37 Mon Jul 26 14:29:23 2022
From: Ionel-Catalin Mititelu <ionel-catalin.mititelu@intel.com>
Date: Wed, 26 Jul 2022 14:29:23 +0300
Subject: [PATCH] Fix VLA parameter warning

Make VLA buffer types consistent in declarations and definitions.
Resolves build crash when using -Werror due to "vla-parameter" warning.

Signed-off-by: Adrian Herrera <adr.her.arc.95@gmail.com>

--- a/BaseTools/Source/C/BrotliCompress/brotli/c/dec/decode.c	2021-04-29 20:20:08.000000000 +0300
+++ b/BaseTools/Source/C/BrotliCompress/brotli/c/dec/decode.c	2022-07-26 14:29:23.456334486 +0300
@@ -2030,8 +2030,10 @@
 }
 
 BrotliDecoderResult BrotliDecoderDecompress(
-    size_t encoded_size, const uint8_t* encoded_buffer, size_t* decoded_size,
-    uint8_t* decoded_buffer) {
+  size_t encoded_size,
+  const uint8_t encoded_buffer[BROTLI_ARRAY_PARAM(encoded_size)],
+  size_t* decoded_size,
+  uint8_t decoded_buffer[BROTLI_ARRAY_PARAM(*decoded_size)]) {
   BrotliDecoderState s;
   BrotliDecoderResult result;
   size_t total_out = 0;
   
--- a/BaseTools/Source/C/BrotliCompress/brotli/c/enc/encode.c	2021-04-29 20:20:08.000000000 +0300
+++ b/BaseTools/Source/C/BrotliCompress/brotli/c/enc/encode.c	2022-07-26 14:29:23.436334486 +0300
@@ -1470,8 +1470,9 @@
 
 BROTLI_BOOL BrotliEncoderCompress(
     int quality, int lgwin, BrotliEncoderMode mode, size_t input_size,
-    const uint8_t* input_buffer, size_t* encoded_size,
-    uint8_t* encoded_buffer) {
+    const uint8_t input_buffer[BROTLI_ARRAY_PARAM(input_size)],
+    size_t* encoded_size,
+    uint8_t encoded_buffer[BROTLI_ARRAY_PARAM(*encoded_size)]) {
   BrotliEncoderState* s;
   size_t out_size = *encoded_size;
   const uint8_t* input_start = input_buffer;
